<!DOCTYPE html>
<html lang="en">
  <head>
    <title>API Documentation for lib/model.js - Backbone.ioBind
    </title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
    <script src="/backbone.iobind/public/js/prettify.js"></script>
    <script src="/backbone.iobind/public/js/main.js"></script>
    <link rel="stylesheet" href="/backbone.iobind/public/css/main.css" type="text/css" media="all">
    <link href="http://fonts.googleapis.com/css?family=Lato:100,300" rel="stylesheet" type="text/css">
    <script type="text/javascript">var mpq = [];
mpq.push(["init", "475f5f9de5b14b24b0284134e00e4b1b"]);
(function(){var b,a,e,d,c;b=document.createElement("script");b.type="text/javascript";
b.async=true;b.src=(document.location.protocol==="https:"?"https:":"http:")+
"//api.mixpanel.com/site_media/js/api/mixpanel.js";a=document.getElementsByTagName("script")[0];
a.parentNode.insertBefore(b,a);e=function(f){return function(){mpq.push(
[f].concat(Array.prototype.slice.call(arguments,0)))}};d=["init","track","track_links",
"track_forms","register","register_once","identify","name_tag","set_config"];for(c=0;c<
d.length;c++){mpq[d[c]]=e(d[c])}})();
</script>
    <script type="text/javascript">var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-26183904-3']);
_gaq.push(['_trackPageview']);
(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>
  </head>
  <body>
    <nav>
      <ul class="sections">
        <li class="keepcase"><a href="#ioBind" class="scroll">ioBind</a>
        </li>
        <li class="keepcase"><a href="#ioUnbind" class="scroll">ioUnbind</a>
        </li>
        <li class="keepcase"><a href="#ioUnbindAll" class="scroll">ioUnbindAll</a>
        </li>
      </ul>
      <ul class="pages">
        <li><a href="/backbone.iobind">Home</a>
        </li>
      </ul>
      <ul class="code">
        <li class="header"><a href="/backbone.iobind/code/">API Documentation</a>
        </li>
        <li><a href="/backbone.iobind/code/model.html">lib/model.js</a>
        </li>
        <li><a href="/backbone.iobind/code/collection.html">lib/collection.js</a>
        </li>
        <li><a href="/backbone.iobind/code/sync.html">lib/sync.js</a>
        </li>
      </ul>
    </nav>
    <header>
      <h1><a href="/backbone.iobind">Backbone.ioBind</a>
      </h1>
      <div class="description"><p>ioBind is a plugin for <a href="http://documentcloud.github.com/backbone/">Backbone</a> that makes it easy to bind <a href="http://socket.io/">Socket.io</a> events to models and collections. This can be as easy as using the included replacement for Backbone.sync, or you can bind to your own events. Or both!</p>
      </div>
      <div class="gh">
        <h4>Latest Update to Github
        </h4>
        <div id="commit"><span id="latestCommitTime">Loading...</span><a id="latestCommitURL"></a>
        </div>
        <div id="latestCommitMessage">Loading...
        </div>
        <div id="clone"><a href="https://github.com/logicalparadox/backbone.iobind" class="button fork">Fork me on GitHub</a>
          <div class="clone">git clone https://github.com/logicalparadox/backbone.iobind.git
          </div>
        </div>
        <div id="links"><a id="repoIssues" href="https://github.com/logicalparadox/backbone.iobind/issues">GitHub Issues</a><a id="repoDownload" href="https://github.com/downloads/logicalparadox/backbone.iobind/backbone.iobind-0.4.1.zip">Download v0.4.1
</a>
        </div>
      </div>
    </header>
    <section id="content">
      <div id="code">
        <article id="ioBind-section" class="codeblock">
          <div class="header"><h1>.ioBind(event, callback, [context])</h1>
          </div>
          <div class="tags">
            <!-- ignroing this-->
            <div class="tag"><span class="type">&#64;param</span><span class="types">&#123; String &#125;</span><span class="name">eventName</span><span class="desc"></span>
            </div>
            <div class="tag"><span class="type">&#64;param</span><span class="types">&#123; Object &#125;</span><span class="name">io</span><span class="desc">from active socket.io connection (optional)</span>
            </div>
            <div class="tag"><span class="type">&#64;param</span><span class="types">&#123; Function &#125;</span><span class="name">callback</span><span class="desc"></span>
            </div>
            <div class="tag"><span class="type">&#64;param</span><span class="types">&#123; Object &#125;</span><span class="name">context</span><span class="desc">(optional) object to interpret as this on callback</span>
            </div>
            <div class="tag"><span class="type">&#64;api</span><span class="visibility">public</span>
            </div>
          </div>
          <div class="description"><p>Bind and handle trigger of socket.io events for models.</p>

<h3>Guidelines</h3>

<p>Do NOT bind to reserved backbone events, such as <code>change</code>, <code>remove</code>, and <code>add</code>.<br />Proxy these events using different event tags such as <code>update</code>, <code>delete</code>, and <code>create</code>.</p>

<p>The socket.io socket must either exist at <code>window.socket</code>, <code>Backbone.socket</code>, or<br /><code>this.socket</code> or it must be passed as the second argument.</p>

<h3>Example</h3>

<ul>
<li>Model definition has url: <code>my_model</code></li>
<li>Model instance has id: <code>abc123</code></li>
</ul>

<h4>Create a new bind (client-side):</h4>

<pre><code>model.ioBind('update', window.io, this.updateView, this);
</code></pre>

<h4>Send socket.io message (server-side)</h4>

<pre><code>socket.emit( 'my_model/abc123:update', { title: 'My New Title' } );
</code></pre>
          </div>
          <div class="view-source">View Source
          </div>
          <div class="code-wrap">
            <pre class="source prettyprint"><code>Backbone.Model.prototype.ioBind = function (eventName, io, callback, context) {
  var ioEvents = this._ioEvents || (this._ioEvents = {})
    , globalName = _.result(this, 'url') + ':' + eventName
    , self = this;
  if ('function' == typeof io) {
    context = callback;
    callback = io;
    io = this.socket || window.socket || Backbone.socket;
  }
  var event = {
    name: eventName,
    global: globalName,
    cbLocal: callback,
    cbGlobal: function () {
      var args = [eventName];
      args.push.apply(args, arguments);
      self.trigger.apply(self, args);
    }
  };
  this.bind(event.name, event.cbLocal, (context || self));
  io.on(event.global, event.cbGlobal);
  if (!ioEvents[event.name]) {
    ioEvents[event.name] = [event];
  } else {
    ioEvents[event.name].push(event);
  }
  return this;
};</code>
            </pre>
          </div>
        </article>
        <article id="ioUnbind-section" class="codeblock">
          <div class="header"><h1>.ioUnbind(event, [callback])</h1>
          </div>
          <div class="tags">
            <!-- ignroing this-->
            <div class="tag"><span class="type">&#64;param</span><span class="types">&#123; String &#125;</span><span class="name">eventName</span><span class="desc"></span>
            </div>
            <div class="tag"><span class="type">&#64;param</span><span class="types">&#123; Object &#125;</span><span class="name">io</span><span class="desc">from active socket.io connection</span>
            </div>
            <div class="tag"><span class="type">&#64;param</span><span class="types">&#123; Function &#125;</span><span class="name">callback</span><span class="desc">(optional) If not provided will remove all callbacks for eventname.</span>
            </div>
            <div class="tag"><span class="type">&#64;api</span><span class="visibility">public</span>
            </div>
          </div>
          <div class="description"><p>Unbind model triggers and stop listening for server events for a specific<br />event and optional callback.</p>

<p>The socket.io socket must either exist at <code>window.socket</code>, <code>Backbone.socket</code>,<br />or <code>this.socket</code> or it must be passed as the second argument.</p>
          </div>
          <div class="view-source">View Source
          </div>
          <div class="code-wrap">
            <pre class="source prettyprint"><code>Backbone.Model.prototype.ioUnbind = function (eventName, io, callback) {
  var ioEvents = this._ioEvents || (this._ioEvents = {})
    , globalName = this.url() + ':' + eventName;
  if ('function' == typeof io) {
    callback = io;
    io = this.socket || window.socket || Backbone.socket;
  }
  var events = ioEvents[eventName];
  if (!_.isEmpty(events)) {
    if (callback &amp;&amp; 'function' === typeof callback) {
      for (var i = 0, l = events.length; i &lt; l; i++) {
        if (callback == events[i].cbLocal) {
          this.unbind(events[i].name, events[i].cbLocal);
          io.removeListener(events[i].global, events[i].cbGlobal);
          events[i] = false;
        }
      }
      events = _.compact(events);
    } else {
      this.unbind(eventName);
      io.removeAllListeners(globalName);
      delete io.$events[globalName];
    }
    if (events.length === 0) {
      delete ioEvents[eventName];
    }
  }
  return this;
};</code>
            </pre>
          </div>
        </article>
        <article id="ioUnbindAll-section" class="codeblock">
          <div class="header"><h1>.ioUnbindAll()</h1>
          </div>
          <div class="tags">
            <!-- ignroing this-->
            <div class="tag"><span class="type">&#64;param</span><span class="types">&#123; Object &#125;</span><span class="name">io</span><span class="desc">from active socket.io connection</span>
            </div>
            <div class="tag"><span class="type">&#64;api</span><span class="visibility">public</span>
            </div>
          </div>
          <div class="description"><p>Unbind all callbacks and server listening events for the given model.</p>

<p>The socket.io socket must either exist at <code>window.socket</code>, <code>Backbone.socket</code>,<br />or <code>this.socket</code> or it must be passed as the only argument.</p>
          </div>
          <div class="view-source">View Source
          </div>
          <div class="code-wrap">
            <pre class="source prettyprint"><code>Backbone.Model.prototype.ioUnbindAll = function (io) {
  var ioEvents = this._ioEvents || (this._ioEvents = {});
  if (!io) io = this.socket || window.socket || Backbone.socket;
  for (var ev in ioEvents) {
    this.ioUnbind(ev, io);
  }
  return this;
};</code>
            </pre>
          </div>
        </article>
      </div>
    </section>
    <footer>
      <div class="branding">Backbone.ioBind is&nbsp;<a href="http://alogicalparadox.com">a logical paradox</a>. site generated by
<a href="http://codexjs.com">codex.</a>
      </div>
    </footer>
  </body>
</html>